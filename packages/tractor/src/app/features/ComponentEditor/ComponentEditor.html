<section class="file-tree">
    <h3>Component files:</h3>
    <ul class='file-tree__file-list file-tree__file-list--javascript'>
        <li ng-repeat="componentFileName in componentEditor.componentFileNames"
            ng-click="componentEditor.openComponentFile(componentFileName)"
            ng-class="{ true: 'active' }[componentFileName === componentEditor.component.name]"
            class="file-tree__file-list-file">
            <span>{{ componentFileName }}</span>
        </li>
    </ul>
</section>

<section class="file-options">
    <h2 class="file-options__name">{{ componentEditor.component.name }}</h2>
    <div>
        <tractor-variable-input class="file-options__name-input" label="Name" model="componentEditor.component" class="true"></tractor-variable-input>
        <tractor-action class="file-options__save-file" model="componentEditor" action="Save component file"></tractor-action>
    </div>
</section>

<section class="file-editor">
    <section ng-show="componentEditor.component.name">
        <section class="file-editor__container">
            <h3>Elements:</h3>

            <section ng-if="componentEditor.component.domElements.length">
                <ul>
                    <li class="file-editor__list-item" ng-repeat="domElement in componentEditor.component.domElements">
                        <tractor-action model="componentEditor.component" action="Remove element" argument="domElement" icon="remove"></tractor-action>

                        <tractor-variable-input label="Name" model="domElement"></tractor-variable-input>
                        <tractor-select label="Type" model="domElement.filters[0]"></tractor-select>
                        <tractor-text-input label="Locator" model="domElement.filters[0]"></tractor-text-input>

                        <section>
                            <h4>Filters:</h4>

                            <ol ng-if="domElement.filters.length > 1" as-sortable ng-model="domElement.filters" is-disabled="domElement.filters.length < 3">
                                <li class="file-editor__list-item" ng-repeat="filter in domElement.filters.slice(1)" as-sortable-item>
                                    <tractor-action model="domElement" action="Remove filter" argument="filter" icon="remove"></tractor-action>
                                    <div ng-if="domElement.filters.length > 2" class="file-editor__sort-handle" as-sortable-item-handle title="Drag to sort"></div>

                                    <tractor-select ng-if="!domElement.filters[$index].isAll" label="Type" model="filter"></tractor-select>
                                    <tractor-text-input label="Locator" model="filter"></tractor-text-input>
                                </li>
                            </ol>

                            <tractor-action model="domElement" action="Add filter"></tractor-action>
                        </section>
                    </li>
                </ul>
            </section>

            <tractor-action model="componentEditor.component" action="Add element"></tractor-action>
        </section>

        <section class="file-editor__container">
            <h3>Actions:</h3>

            <section ng-if="componentEditor.component.actions.length">
                <ul>
                    <li class="file-editor__list-item" ng-repeat="action in componentEditor.component.actions">
                        <tractor-action model="componentEditor.component" action="Remove action" argument="action" icon="remove"></tractor-action>

                        <tractor-variable-input label="Name" model="action"></tractor-variable-input>

                        <section>
                            <h4>Parameters:</h4>

                            <section>
                                <ol ng-if="action.parameters.length" as-sortable ng-model="action.parameters" is-disabled="action.parameters.length < 2">
                                    <li class="file-editor__list-item" ng-repeat="parameter in action.parameters" as-sortable-item>
                                        <tractor-action model="action" action="Remove parameter" argument="parameter" icon="remove"></tractor-action>
                                        <div ng-if="action.parameters.length > 1" class="file-editor__sort-handle" as-sortable-item-handle title="Drag to sort"></div>

                                        <tractor-variable-input label="Name" model="parameter"></tractor-variable-input>
                                    </li>
                                </ol>
                            </section>

                            <tractor-action model="action" action="Add parameter"></tractor-action>
                        </section>

                        <section>
                            <h4>Interactions:</h4>

                            <section>
                                <ol ng-if="action.interactions.length" as-sortable ng-model="action.interactions" is-disabled="action.interactions.length < 2">
                                    <li class="file-editor__list-item" ng-repeat="interaction in action.interactions" as-sortable-item>
                                        <tractor-action model="action" action="Remove interaction" argument="interaction" icon="remove"></tractor-action>
                                        <div ng-if="action.interactions.length > 1" class="file-editor__sort-handle" as-sortable-item-handle title="Drag to sort"></div>

                                        <tractor-select label="Element" model="interaction" options="componentEditor.component.elements" as="name"></tractor-select>
                                        <tractor-select label="Method" model="interaction" options="interaction.element.methods" as="name"></tractor-select>
                                        <tractor-literal-input ng-repeat="argument in interaction.arguments" name="interaction.method.arguments[$index].name" model="argument.value" optional="argument.optional"></tractor-literal-input>
                                    </li>
                                </ol>
                            </section>

                            <tractor-action model="action" action="Add interaction"></tractor-action>
                        </section>
                    </li>
                </ul>
            </section>

            <tractor-action model="componentEditor.component" action="Add action"></tractor-action>
        </section>
    </section>
</section>
